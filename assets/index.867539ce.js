var S=Object.defineProperty;var b=(t,e,r)=>e in t?S(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var c=(t,e,r)=>(b(t,typeof e!="symbol"?e+"":e,r),r);const x=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}};x();class w{constructor(){c(this,"boardArray",[]);c(this,"pixelSize",12);c(this,"food",null);c(this,"board_width",80);c(this,"board_height",50);c(this,"highScore",null);c(this,"render_speed",100);c(this,"showGrids",!1);c(this,"score",0);for(let e=0;e<this.board_height;e++){this.boardArray.push([]);for(let r=0;r<this.board_width;r++){const n=document.createElement("div");this.boardArray[e][r]=n,n.style.position="absolute",n.style.left=r*this.pixelSize+"px",n.style.top=e*this.pixelSize+"px",n.style.width=this.pixelSize+"px",n.style.height=this.pixelSize+"px"}}}init(e){this.boardArray.forEach(r=>{r.forEach(n=>{e.appendChild(n)})}),this.getHighScore()}getHighScore(e){const r=e||JSON.parse(localStorage.getItem("hs")||"null");this.highScore=r||0}setHighScore(){localStorage.setItem("hs",JSON.stringify(this.score)),this.highScore=this.score}getFoodLocation(){return this.food}createFood(){const e=Math.floor(Math.random()*this.board_width),r=Math.floor(Math.random()*this.board_height);this.boardArray[r][e].style.backgroundColor="green",this.food={x:e,y:r}}updateSquareAtPosition(e,r){r(this.boardArray[e.y][e.x])}updateAllSquares(e){this.boardArray.forEach(r=>{r.forEach(n=>e(n))})}}class m{constructor(e){c(this,"initialState",[{x:0,y:0},{x:1,y:0},{x:2,y:0},{x:3,y:0}]);c(this,"state",this.initialState);this.state=e||this.initialState}getCurrentState(){return[...this.state]}getLength(){return this.state.length}updateState(e){this.state=e}sliceSnek(e){const r=this.state.findIndex(i=>i.y===e.y&&i.x===e.x),n=this.state.slice(0,r+1);return this.state=this.state.slice(r+1),n}getCurrentHead(){if(!this.state[this.getLength()-1])debugger;return this.state[this.getLength()-1]}}const k=document.querySelector("#app"),L=document.querySelector("#change-border"),_=document.querySelector("#high-score"),A=document.querySelector("#score"),C=document.querySelector("#snake-speed"),q=document.querySelector("#snake-length"),o=new w;o.init(k);u();function u(){_.textContent=o.highScore+""}const d=new m,v=o.render_speed;let a="right";L.onclick=()=>{o.showGrids?(o.updateAllSquares(t=>{t.style.border=""}),o.showGrids=!1):(o.updateAllSquares(t=>{t.style.border="1px solid #aaa"}),o.showGrids=!0)};function f(t){o.updateSquareAtPosition(t,e=>{e.style.backgroundColor="#fff"})}function g(t,e){switch(t){case"right":return a="right",{x:(e.x+1+o.board_width)%o.board_width,y:e.y};case"down":return a="down",{x:e.x,y:(e.y+1+o.board_height)%o.board_height};case"left":return a="left",{x:(e.x-1+o.board_width)%o.board_width,y:e.y};case"up":return a="up",{x:e.x,y:(e.y-1+o.board_height)%o.board_height};default:return e}}function E(t,e){let r=null,n=t.length;for(let i=0;i<n-1;i++)if(t[i].x===e.x&&t[i].y===e.y){r=t[i];break}return r}function F(){let t=Math.floor(d.getLength()/10),e=v;for(;t;)e-=10,t--;e&&(o.render_speed=e)}function H(){o.getFoodLocation()&&o.updateSquareAtPosition(o.getFoodLocation(),t=>{t.style.backgroundColor!=="green"&&(t.style.backgroundColor="green")})}function h(t){const e=d.getCurrentState(),r=e.shift();f(r);const n=e[e.length-1];let i=g(t,n);e.push(i),d.updateState(e);let s=E(e,i);if(s){const l=d.sliceSnek(s);o.score-=l.length,l.forEach(f)}P(d.getCurrentHead()),F()}function y(){o.createFood()}function P(t){const e=o.getFoodLocation();if(!!e&&e)if(e.x===t.x&&e.y===t.y){const r=d.getCurrentState(),n=g(a,t);r.push(n),d.updateState(r),y(),o.score++}else return}function M(){d.getCurrentState().forEach(t=>{o.updateSquareAtPosition(t,e=>{e.style.backgroundColor="crimson"})})}function B(){q.textContent=d.getLength()+"",C.textContent=100-o.render_speed?100-o.render_speed+"":"1",A.textContent=o.score+"",o.score>o.highScore&&o.setHighScore(),u()}window.addEventListener("keydown",t=>{switch(t.key){case"ArrowDown":a!="up"&&a!="down"&&h("down");break;case"ArrowUp":a!="down"&&a!="up"&&h("up");break;case"ArrowLeft":a!="right"&&a!="left"&&h("left");break;case"ArrowRight":a!="left"&&a!="right"&&h("right");break}});y();function p(){h(a),H(),B(),M(),setTimeout(p,o.render_speed)}p();
